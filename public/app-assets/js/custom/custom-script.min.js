
$(document).ready(function () {

    //window.open("data:x-application/CWSRun.exe /USERNAME=TRNDSI /PASSWORD=TRNDSI /UAC=XXXX")



    /**
     * modal
     */
    $('.modal').modal();


    /**
     * axios

    $('#form_patient_ipp').on('focusout',function () {
        if ($(this).val())
            control($(this).val())
    })
     */

    function control (ipp){
        axios({
            method: 'post',
            url: '/formulaire/check/patient/'+ipp,
        })
            .then(function (reponse) {
                data = reponse.data
                console.log(data['PRE_PAT'])
                if (data !== 'false'){
                    $('#form_patient_ipp').css({'color':'green'})
                    $('#form_patient_prenom').val(data['PRE_PAT'])
                    $('#form_patient_nom').val(data['NOM_PAT'])

                    if (data['DAT_NAISS']){
                        str = data['DAT_NAISS']
						/*
                        annee = str.substring(0,4);
                        mois = str.substring(4,6);
                        jour = str.substring(6,8);

                        date = annee+'-'+mois+'-'+jour
						*/
						date = str.substring(0,10);
                        console.log(date)
                        $('#form_patient_ddn').val(date)
                    }
                    /*
                    console.log(data['COD_SEXE'] )
					if (data['COD_SEXE'] === "1"){
                        $('#form_patient_sexe').val("F")
                        $('#form_patient_sexe').formSelect()
                    }
                    if (data['COD_SEXE'] === "2"){
                        $('#form_patient_sexe').val("H")
                        $('#form_patient_sexe').formSelect()
                    }

                     */

                    iziToast.success({
                        position: 'topRight',
                        id: 'question',
                        displayMode: 2, // 'once', 'replace'
                        timeout: 10000,
                        title: 'Succes',
                        message: 'Patient trouvé dans CLINICOM',
                    });

                    calculeAge()

                }else{
                    $('#form_patient_ipp').css({'color':'red'})

                    iziToast.error({
                        timeout: 10000,
                        position: 'topRight',
                        id: 'question',
                        displayMode: 2, // 'once', 'replace'
                        title: 'Erreur',
                        message: "Ce patient n'existe pas dans CLINICOM",
                    });
                }

            })
            .catch(function (erreur) {
                console.log(erreur);
            });
    }



    /**
     * Début d'initialisation des champs'
     */

    cancer()
    diabete()
    respiratoire()
    chiru()
    suite()
    cardiopathie()
    wedge()
    decomp()
    lobectomie()
    conversion()
    usc()
    chimio_post()
    radio_post()
    recidive()
    deces()
    chimio_pre()
    reponse()
    immune()
    paraneo()
    dossierPrePreop()
    patientInProtocole()
    decisionConRcp()
    dossierPrePost()
    intervConvforRcp()
    rcp_ryth()
    tabagisme()
    calculeImc()
    calculeDureeHospi()
    calculedureeSuivi()
    calculeAge()



    if ($("#form_patient_chir_geste").val() !== "Autre"){
        $('#form_patient_autre_chir_geste').attr('disabled','disabled')
        $('#form_patient_autre_chir_geste').val('')
    }
    var str = $("#form_patient_chir_abord").val()
    var n = str.includes("thoracoscopie");

    if (!n){
        $('#divRobot').hide()
       $('#form_patient_chir_thoracos').val('')
    }
    if (str !== "Autre"){
        $('#divAutre').hide()
        $('#form_patient_autre_chir_abord').val('')
    }

    if ($("#form_patient_histo_pre_op").val() !== "Autre"){
        $('#form_patient_autre_histo_pre_op').attr('disabled','disabled')
        $('#form_patient_autre_histo_pre_op').val('')
    }

    if ($("#form_patient_mode_obt_his_pre_ope").val() !== "Autre"){
        $('#form_patient_autre_mode_obt_his_pre_ope').attr('disabled','disabled')
        $('#form_patient_autre_mode_obt_his_pre_ope').val('')
    }

    if ($("#form_patient_cons_neu_dep_mg_pre_op").val() !== "Autre"){
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').attr('disabled','disabled')
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').val('')
    }

    if ($("#form_patient_epp").val() !== "Autre"){
        $('#form_patient_epp_autre').attr('disabled','disabled')
        $('#form_patient_epp_autre').val('')
    }

    if ($("#form_patient_anticorps_anti_rach").val() !== "Autre"){
        $('#form_patient_anticr_autre').attr('disabled','disabled')
        $('#form_patient_anticr_autre').val('')
    }



    if ($("#form_patient_trai_fond_myasthenie").val() !== "Autre"){
        $('#form_patient_autre_trai_fond_myasthenie').attr('disabled','disabled')
        $('#form_patient_autre_trai_fond_myasthenie').val('')
    }

    if ($("#form_patient_tdm").val() !== "Oui"){
        $('#form_patient_autre_tdm').attr('disabled','disabled')
        $('#form_patient_autre_tdm').val('')
    }
/*
    if ($("#form_patient_tdm").val() !== "Autre"){
        $('#form_patient_tdm_autre').attr('disabled','disabled')
        $('#form_patient_tdm_autre').val('')
    }

*/
    if ($("#form_patient_petscan").val() !== "Oui"){
        $('#form_patient_autre_petscan').attr('disabled','disabled')
        $('#form_patient_autre_petscan').val('')
    }

    if ($("#form_patient_petscan").val() !== "Autre"){
       // $('#form_patient_petscan_autre').attr('disabled','disabled')
        //$('#form_patient_petscan_autre').val('')
    }



    if ($("#form_patient_tnm_t").val() !== "Autre"){
        $('#form_patient_autre_tnm_t').attr('disabled','disabled')
        $('#form_patient_autre_tnm_t').val('')
    }

    if ($("#form_patient_tnm_n").val() !== "Autre"){
        $('#form_patient_autre_tnm_n').attr('disabled','disabled')
        $('#form_patient_autre_tnm_n').val('')
    }

    if ($("#form_patient_tnm_m").val() !== "Autre"){
        $('#form_patient_autre_tnm_m').attr('disabled','disabled')
        $('#form_patient_autre_tnm_m').val('')
    }

    if ($("#form_patient_tnm_stade_ctnm").val() !== "Autre"){
        $('#form_patient_autre_stade').attr('disabled','disabled')
        $('#form_patient_autre_stade').val('')
    }

    if ($("#form_patient_post_tnm_t").val() !== "Autre"){
        $('#form_patient_autre_post_tnm_t').attr('disabled','disabled')
        $('#form_patient_autre_post_tnm_t').val('')
    }

    if ($("#form_patient_anapath_post_op").val() !== "Autre"){
        $('#form_patient_autre_anapath_post_op').attr('disabled','disabled')
        $('#form_patient_autre_anapath_post_op').val('')
    }

    if ($("#form_patient_post_tnm_n").val() !== "Autre"){
        $('#form_patient_autre_post_tnm_n').attr('disabled','disabled')
        $('#form_patient_autre_post_tnm_n').val('')
    }

    if ($("#form_patient_post_tnm_m").val() !== "Autre"){
        $('#form_patient_autre_post_tnm_m').attr('disabled','disabled')
        $('#form_patient_autre_post_tnm_m').val('')
    }

    if ($("#form_patient_post_tnm_stade_ctnm").val() !== "Autre"){
        $('#form_patient_autre_post_tnm_stade_ctnm').attr('disabled','disabled')
        $('#form_patient_autre_post_tnm_stade_ctnm').val('')
    }

    if ($("#form_patient_chirurgien_referent").val() !== "Autre"){
        $('#form_patient_autre_chirurgien_referent').attr('disabled','disabled')
        $('#form_patient_autre_chirurgien_referent').val('')
    }


    if ($("#form_patient_service_adresseur").val() !== "Autre"){
        $('#form_patient_service_adresseur_autre').attr('disabled','disabled')
        $('#form_patient_service_adresseur_autre').val('')
    }

    if ($("#form_patient_maladie_auto_immune_liste").val() !== "Autre"){
        $('#form_patient_maladi_auto_imm_assoc').attr('disabled','disabled')
        $('#form_patient_maladi_auto_imm_assoc').val('')
    }


    /**
     * Fin d'initialisation des champs'
     */



    /**
     * Début des calculs
     */

    $('#form_patient_poids').on('change',function ($) {
       calculeImc()
   })

    $('#form_patient_taille').on('change',function ($) {
        calculeImc()
    })

    $('#form_patient_chir_date_ope').on('change',function ($) {
        calculeDureeHospi()
        calculedureeSuivi()
    })

    $('#form_patient_service_adresseur').on('change',function ($) {
        serviceAdresseurOnChange()
    })

    $('#form_patient_post_op_date_sortie').on('change',function ($) {
        calculeDureeHospi()
    })

    $('#form_patient_date_der_nouvelles').on('change',function ($) {
        calculedureeSuivi()
    })

    $('#form_patient_ddn').on('change',function ($) {
        calculeAge()
    })

    $("#form_patient_cancer").on('change',function () {
         cancer()
    })

    $("#form_patient_diabete").on('change',function () {
        diabete()
    })

    $("#form_patient_co_chirurgie").on('change',function () {
        chiru()
    })

    $("#form_patient_co_respiratoire").on('change',function () {
        respiratoire()
    })


    $("#form_patient_cardiopathie").on('change',function () {
        cardiopathie()
    })

    $("#form_patient_tabagisme").on('change',function () {
        tabagisme()
    })

    $("#form_patient_wedge").on('change',function () {
        wedge()
    })
    $("#form_patient_decomp_post").on('change',function () {
        decomp()
    })


    $("#form_patient_lobectomie").on('change',function () {
        lobectomie()
    })

    $("#conversion").on('change',function () {
        conversion()
    })

    $("#suite").on('change',function () {
        suite()
    })

    $("#usc").on('change',function () {
        usc()
    })

    $("#chimio_post_op").on('change',function () {
        chimio_post()
    })

    $("#radio_post_op").on('change',function () {
        radio_post()
    })

    $("#recidive").on('change',function () {
        recidive()
    })

    $("#deces").on('change',function () {
        deces()
    })

    $("#chimiopreop").on('change',function () {
        chimio_pre()
    })

    $("#reponse").on('change',function () {
        reponse()
    })

    $("#immune").on('change',function () {
        immune()
    })

    $("#paraneo").on('change',function () {
        paraneo()
    })

    $("#dossierPrePreop").on('change',function () {
        dossierPrePreop()
    })

    $("#patientInProtocole").on('change',function () {
        patientInProtocole()
    })


    $("#decisionConRcp").on('change',function () {
        decisionConRcp()
    })


    $("#intervConvforRcp").on('change',function () {
        intervConvforRcp()
    })

    $("#dossierPrePost").on('change',function () {
        dossierPrePost()
    })

    $("#rcp_ryth").on('change',function () {
        rcp_ryth()
    })
    $("#form_patient_maladie_auto_immune_liste").on('change',function () {
        maladieAutoImmuneListeOnChange()
    })



    /**
     * Fin des calculs
     */



    /**
     * Début traitement particuliére
     */

    $('textarea#form_patient_radiotherapie_post_op, textarea#form_patient_chimio_post_op,' +
        ' textarea#form_patient_suivi_myasthenie, textarea#form_patient_localisation_recidive, textarea#form_patient_traitement_rechute_recidive,' +
        ' textarea#form_patient_cause_deces, input#form_patient_num_acp').characterCounter();

    /**
     * Fin traitement particuliére
     */

})

function tpOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_post_tnm_t').removeAttr('disabled')
        $('#form_patient_autre_post_tnm_t').focus()
    }else{
        $('#form_patient_autre_post_tnm_t').attr('disabled','disabled')
        $('#form_patient_autre_post_tnm_t').val('')
    }
}

function npOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_post_tnm_n').removeAttr('disabled')
        $('#form_patient_autre_post_tnm_n').focus()
    }else{
        $('#form_patient_autre_post_tnm_n').attr('disabled','disabled')
        $('#form_patient_autre_post_tnm_n').val('')
    }
}

function mpOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_post_tnm_m').removeAttr('disabled')
        $('#form_patient_autre_post_tnm_m').focus()
    }else{
        $('#form_patient_autre_post_tnm_m').attr('disabled','disabled')
        $('#form_patient_autre_post_tnm_m').val('')
    }
}

function stadepOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_post_tnm_stade_ctnm').removeAttr('disabled')
        $('#form_patient_autre_post_tnm_stade_ctnm').focus()
    }else{
        $('#form_patient_autre_post_tnm_stade_ctnm').attr('disabled','disabled')
        $('#form_patient_autre_post_tnm_stade_ctnm').val('')
    }
}

function histopOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_anapath_post_op').removeAttr('disabled')
        $('#form_patient_autre_anapath_post_op').focus()
    }else{
        $('#form_patient_autre_anapath_post_op').attr('disabled','disabled')
        $('#form_patient_autre_anapath_post_op').val('')
    }
}

function gesteOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_chir_geste').removeAttr('disabled')
        $('#form_patient_autre_chir_geste').focus()
    }else{
        $('#form_patient_autre_chir_geste').attr('disabled','disabled')
        $('#form_patient_autre_chir_geste').val('')
    }
}

function abordOnChange(event) {
    var str = $(event.target).val()
    var n = str.includes("thoracoscopie");
    if (n){
        $('#divRobot').show()
    }else{
        $('#form_patient_chir_thoracos').val('')
        $('#divRobot').hide()
    }

    if (str === "Autre"){
        $('#divAutre').show()
        $('#divRobot').hide()
    }else{
        $('#divAutre').hide()
    }
}

function tOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_tnm_t').removeAttr('disabled')
        $('#form_patient_autre_tnm_t').focus()
    }else{
        $('#form_patient_autre_tnm_t').attr('disabled','disabled')
        $('#form_patient_autre_tnm_t').val('')
    }
}

function nOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_tnm_n').removeAttr('disabled')
        $('#form_patient_autre_tnm_n').focus()
    }else{
        $('#form_patient_autre_tnm_n').attr('disabled','disabled')
        $('#form_patient_autre_tnm_n').val('')
    }
}

function mOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_tnm_m').removeAttr('disabled')
        $('#form_patient_autre_tnm_m').focus()
    }else{
        $('#form_patient_autre_tnm_m').attr('disabled','disabled')
        $('#form_patient_autre_tnm_m').val('')
    }
}

function stadeOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_stade').removeAttr('disabled')
        $('#form_patient_autre_stade').focus()
    }else{
        $('#form_patient_autre_stade').attr('disabled','disabled')
        $('#form_patient_autre_stade').val('')
    }
}

function tdmOnChange(event) {

    if ($(event.target).val() === "Oui"){
        $('#form_patient_autre_tdm').removeAttr('disabled')
        $('#form_patient_autre_tdm').focus()
      //  $('#form_patient_tdm_autre').attr('disabled','disabled')
      //  $('#form_patient_tdm_autre').val('')
    }else{
        if ($(event.target).val() === "Autre"){
         //   $('#form_patient_tdm_autre').removeAttr('disabled')
         //   $('#form_patient_tdm_autre').focus()
        }else{

            $('#form_patient_autre_tdm').attr('disabled','disabled')
            $('#form_patient_autre_tdm').val('')
          //  $('#form_patient_tdm_autre').attr('disabled','disabled')
          //  $('#form_patient_tdm_autre').val('')
        }

    }


}

function petscanOnChange(event) {
    if ($(event.target).val() === "Oui"){

        $('#form_patient_autre_petscan').removeAttr('disabled')
        $('#form_patient_autre_petscan').focus()

    }else{

        if ($(event.target).val() === "Autre" ){

          //  $('#form_patient_petscan_autre').removeAttr('disabled')
           // $('#form_patient_petscan_autre').focus()

            $('#form_patient_autre_petscan').attr('disabled','disabled')
            $('#form_patient_autre_petscan').val('')

        }else{
            $('#form_patient_autre_petscan').attr('disabled','disabled')
            $('#form_patient_autre_petscan').val('')
           // $('#form_patient_petscan_autre').attr('disabled','disabled')
           // $('#form_patient_petscan_autre').val('')
        }
    }
}

function consNeuOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').removeAttr('disabled')
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').focus()
    }else{
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').attr('disabled','disabled')
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').val('')
    }
}

function eppOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_epp_autre').removeAttr('disabled')
        $('#form_patient_epp_autre').focus()
    }else{
        $('#form_patient_epp_autre').attr('disabled','disabled')
        $('#form_patient_epp_autre').val('')
    }
}

function anticorpOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_anticr_autre').removeAttr('disabled')
        $('#form_patient_anticr_autre').focus()
    }else{
        $('#form_patient_anticr_autre').attr('disabled','disabled')
        $('#form_patient_anticr_autre').val('')
    }
}


function traiFondOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_trai_fond_myasthenie').removeAttr('disabled')
        $('#form_patient_autre_trai_fond_myasthenie').focus()
    }else{
        $('#form_patient_autre_trai_fond_myasthenie').attr('disabled','disabled')
        $('#form_patient_autre_trai_fond_myasthenie').val('')
    }
}

function histoOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_histo_pre_op').removeAttr('disabled')
        $('#form_patient_autre_histo_pre_op').focus()
    }else{
        $('#form_patient_autre_histo_pre_op').attr('disabled','disabled')
        $('#form_patient_autre_histo_pre_op').val('')
    }
}

function maladieAutoImmuneListeOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_maladi_auto_imm_assoc').removeAttr('disabled')
        $('#form_patient_maladi_auto_imm_assoc').focus()
    }else{
        $('#form_patient_maladi_auto_imm_assoc').attr('disabled','disabled')
        $('#form_patient_maladi_auto_imm_assoc').val('')
    }
}

function immune(event) {

    var checkBox = document.getElementById("immune");
    if (checkBox.checked){
        $('.malAutoImm').show()
    }else{
        $('.malAutoImm').hide()
    }
}

function serviceAdresseurOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_service_adresseur_autre').removeAttr('disabled')
        $('#form_patient_service_adresseur_autre').focus()
    }else{
        $('#form_patient_service_adresseur_autre').attr('disabled','disabled')
        $('#form_patient_service_adresseur_autre').val('')
    }
}



function modeHistoOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_mode_obt_his_pre_ope').removeAttr('disabled')
        $('#form_patient_autre_mode_obt_his_pre_ope').focus()
    }else{
        $('#form_patient_autre_mode_obt_his_pre_ope').attr('disabled','disabled')
        $('#form_patient_autre_mode_obt_his_pre_ope').val('')
    }
}

function chirOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_chirurgien_referent').removeAttr('disabled')
        $('#form_patient_autre_chirurgien_referent').focus()
    }else{
        $('#form_patient_autre_chirurgien_referent').val('')
        $('#form_patient_autre_chirurgien_referent').attr('disabled','disabled')
    }
}

function cancer() {
    var checkBox = document.getElementById("form_patient_cancer");
    if (checkBox.checked){
        $('#form_patient_cancer_txt').removeAttr('disabled')
        $('#form_patient_cancer_txt').focus()
    }else{
        $('#form_patient_cancer_txt').val('')
        $('#form_patient_cancer_txt').attr('disabled','disabled')
    }
}

function diabete() {
    var checkBox = document.getElementById("form_patient_diabete");
    if (checkBox.checked){
        $('#form_patient_co_diabete_txt').removeAttr('disabled')
        $('#form_patient_co_diabete_txt').focus()
    }else{
        $('#form_patient_co_diabete_txt').val('')
        $('#form_patient_co_diabete_txt').attr('disabled','disabled')
    }
}

function chiru() {
    var checkBox = document.getElementById("form_patient_co_chirurgie");
    if (checkBox.checked){
        $('#form_patient_co_chirurgie_txt').removeAttr('disabled')
        $('#form_patient_co_chirurgie_txt').focus()
    }else{
        $('#form_patient_co_chirurgie_txt').val('')
        $('#form_patient_co_chirurgie_txt').attr('disabled','disabled')
    }
}

function respiratoire() {
    var checkBox = document.getElementById("form_patient_co_respiratoire");
    if (checkBox.checked){
        $('#form_patient_co_respiratoire_txt').removeAttr('disabled')
        $('#form_patient_co_respiratoire_txt').focus()
    }else{
        $('#form_patient_co_respiratoire_txt').val('')
        $('#form_patient_co_respiratoire_txt').attr('disabled','disabled')
    }
}

function chimio_post() {
    var checkBox = document.getElementById("chimio_post_op");
    if (checkBox.checked){
        $('#form_patient_chimio_post_op').removeAttr('disabled')
        $('#form_patient_chimio_post_op').focus()
    }else{
        $('#form_patient_chimio_post_op').attr('disabled','disabled')
        $('#form_patient_chimio_post_op').val('')
    }
}

function radio_post() {
    var checkBox = document.getElementById("radio_post_op");
    if (checkBox.checked){
        $('#form_patient_radiotherapie_post_op').removeAttr('disabled')
        $('#form_patient_radiotherapie_post_op').focus()
    }else{
        $('#form_patient_radiotherapie_post_op').attr('disabled','disabled')
        $('#form_patient_radiotherapie_post_op').val('')
    }
}

function conversion() {
    var checkBox = document.getElementById("conversion");
    if (checkBox.checked){
        $('#form_patient_conversion').removeAttr('disabled')
        $('#form_patient_conversion').focus()
    }else{
        $('#form_patient_conversion').attr('disabled','disabled')
        $('#form_patient_conversion').val('')
    }
}

function lobectomie() {
    var checkBox = document.getElementById("form_patient_lobectomie");
    if (checkBox.checked){
        $('#form_patient_lobectomie_txt').removeAttr('disabled')
        $('#form_patient_lobectomie_txt').focus()
    }else{
        $('#form_patient_lobectomie_txt').attr('disabled','disabled')
        $('#form_patient_lobectomie_txt').val('')
    }
}

function wedge() {
    var checkBox = document.getElementById("form_patient_wedge");
    if (checkBox.checked){
        $('#form_patient_wedge_txt').removeAttr('disabled')
        $('#form_patient_wedge_txt').focus()
    }else{
        $('#form_patient_wedge_txt').attr('disabled','disabled')
        $('#form_patient_wedge_txt').val('')
    }
}

function decomp() {
    var checkBox = document.getElementById("form_patient_decomp_post");
    if (checkBox.checked){
        $('#form_patient_comm_decom_post').removeAttr('disabled')
        $('#form_patient_comm_decom_post').focus()
    }else{
        $('#form_patient_comm_decom_post').attr('disabled','disabled')
        $('#form_patient_comm_decom_post').val('')
    }
}

function cardiopathie() {
    var checkBox = document.getElementById("form_patient_cardiopathie");
    if (checkBox.checked){
        $('#form_patient_cardiopathie_txt').removeAttr('disabled')
        $('#form_patient_cardiopathie_txt').focus()
    }else{
        $('#form_patient_cardiopathie_txt').val('')
        $('#form_patient_cardiopathie_txt').attr('disabled','disabled')
    }
}

function usc() {
    var checkBox = document.getElementById("usc");
    if (checkBox.checked){
        $('#form_patient_rea_usc_post_op').removeAttr('disabled')
        $('#form_patient_rea_usc_post_op').focus()
    }else{
        $('#form_patient_rea_usc_post_op').attr('disabled','disabled')
        $('#form_patient_rea_usc_post_op').val('')
    }
}

function suite() {
    var checkBox = document.getElementById("suite");
    if (checkBox.checked){
        $('#div_suite').show()
    }else{
        $('#div_suite').hide()
    }
}

function recidive() {
    var checkBox = document.getElementById("recidive");
    if (checkBox.checked){
        $('#view-input-fields_10').show()
    }else{
        $('#view-input-fields_10').hide()
    }
}

function deces() {
    var checkBox = document.getElementById("deces");
    if (checkBox.checked){
        $('#cause_deces').show()
        $('#cause_deces').focus()
    }else{
        $('#cause_deces').val('')
        $('#cause_deces').hide()
    }
}

function chimio_pre() {
    var checkBox = document.getElementById("chimiopreop");
    if (checkBox.checked){
        $('#form_patient_chimio_pre_op').removeAttr('disabled')
        $('#form_patient_chimio_pre_op').focus()
        $('#divreponse').show()
    }else{
        $('#form_patient_chimio_pre_op').val('')
        $('#form_patient_chimio_pre_op').attr('disabled','disabled')
        $('#divreponse').hide()
    }
}

function reponse() {
    var checkBox = document.getElementById("reponse");
    if (checkBox.checked){
        $('#form_patient_reponse_chimio_pre_op').show()
        $('#form_patient_reponse_chimio_pre_op').focus()
    }else{
        $('#form_patient_reponse_chimio_pre_op').val('')
        $('#form_patient_reponse_chimio_pre_op').hide()
    }
}

function paraneo() {
    var checkBox = document.getElementById("paraneo");
    if (checkBox.checked){
        $('#form_patient_syndrome_paraneo').removeAttr('disabled')
        $('#form_patient_syndrome_paraneo').focus()
    }else{
        $('#form_patient_syndrome_paraneo').val('')
        $('#form_patient_syndrome_paraneo').attr('disabled','disabled')
    }
}

function dossierPrePreop() {
    intervConvforRcp()
    var checkBox = document.getElementById("dossierPrePreop");
    if (checkBox.checked){
        $('#divintervConvforRcp').show()
    }else{
        $('#divintervConvforRcp').hide()
    }
}

function patientInProtocole() {
    var checkBox = document.getElementById("patientInProtocole");
    if (checkBox.checked){
        $('#divpatientInProtocole').show()
    }else{
        $('#divpatientInProtocole').hide()
    }
}


function decisionConRcp() {
    var checkBox = document.getElementById("decisionConRcp");
    if (!checkBox.checked){
        $('#divdecisionConRcpComm').show()
    }else{
        $('#divdecisionConRcpComm').hide()
    }
}


function intervConvforRcp() {
    var checkBox = document.getElementById("intervConvforRcp");
    var checkBox2 = document.getElementById("dossierPrePreop");
    if (!checkBox.checked && checkBox2.checked){
        $('#divintervConvforRcpComm').show()
    }else{
        $('#divintervConvforRcpComm').hide()
    }
}

function dossierPrePost() {
    var checkBox = document.getElementById("dossierPrePost");
    var checkBox2 = document.getElementById("decisionConRcp");
    if (checkBox.checked){
        $('#divdecisionConRcp').show()
        if (!checkBox2.checked){
            $('#divdecisionConRcpComm').show()
        }
    }else{
        $('#divdecisionConRcp').hide()
        $('#divdecisionConRcpComm').hide()
    }
}







function  rcp_ryth() {
    var checkBox = document.getElementById("rcp_ryth");
    if (checkBox.checked){
        $('#form_patient_rcp_rythmique').removeAttr('disabled')
        $('#form_patient_rcp_rythmique_date').removeAttr('disabled')
        $('#form_patient_rcp_rythmique').focus()
    }else{
        $('#form_patient_rcp_rythmique').val('')
        $('#form_patient_rcp_rythmique').attr('disabled','disabled')
        $('#form_patient_rcp_rythmique_date').attr('disabled','disabled')
        $('#form_patient_rcp_rythmique_date').val('')
    }
}

function tabagisme() {
    var checkBox = document.getElementById("form_patient_tabagisme");
    if (checkBox.checked){
        $('#form_patient_tabagisme_txt').removeAttr('disabled')
        $('#form_patient_tabagisme_txt').focus()
    }else{
        $('#form_patient_tabagisme_txt').val('')
        $('#form_patient_tabagisme_txt').attr('disabled','disabled')
    }
}

function getAge(date) { 
	var diff = Date.now() - date.getTime();
	var age = new Date(diff); 

	return Math.abs(age.getUTCFullYear() - 1970);
}



function calculeAge() {

    if ($('#form_patient_ddn').val()){
        var d = new Date();
        var ddn = new Date($('#form_patient_ddn').val())
		
        var rslt = getAge(ddn)
        $('#form_patient_age').val(rslt)
	

    }else{
        $('#form_patient_age').val(0)
    }
}

function calculeImc() {
    if ($('#form_patient_taille').val()){
        var rst = $('#form_patient_poids').val() /( ($('#form_patient_taille').val()/100) *  ($('#form_patient_taille').val()/100) )

        if (rst.toFixed(1) >= 18.5 && rst.toFixed(1) <= 25 ){
            $('#form_patient_imc').css({
                'color': 'green'
            })
        }

        if (rst.toFixed(1) > 25 && rst.toFixed(1) <= 35 ){
            $('#form_patient_imc').css({
                'color': 'orange'
            })
        }

        if (rst.toFixed(1) < 18.5 || rst.toFixed(1) > 35 ){
            $('#form_patient_imc').css({
                'color': 'red'
            })
        }


        $('#form_patient_imc').val(rst.toFixed(1))
    }else{
        $('#form_patient_imc').val(0)
    }
}

function calculeDureeHospi() {

    if ($('#form_patient_chir_date_ope').val()){

    }

    if ($('#form_patient_post_op_date_sortie').val()){
        $('#form_patient_chir_date_ope').attr('max',$('#form_patient_post_op_date_sortie').val())
    }

    if ($('#form_patient_chir_date_ope').val() && $('#form_patient_post_op_date_sortie').val()){
        // To set two dates to two variables
        var date1 = new Date($('#form_patient_chir_date_ope').val());
        var date2 = new Date($('#form_patient_post_op_date_sortie').val());
        var Difference = (date2 - date1)/86400000;
        $('#duree_hopi').val(Difference)
    }else{
        $('#duree_hopi').val(0)
    }
}

function calculedureeSuivi() {

    if ($('#form_patient_chir_date_ope').val()){
        $('#form_patient_date_der_nouvelles').attr('min',$('#form_patient_chir_date_ope').val())
    }

    if ($('#form_patient_date_der_nouvelles').val()){
        $('#form_patient_chir_date_ope').attr('max',$('#form_patient_date_der_nouvelles').val())
    }

    if ($('#form_patient_chir_date_ope').val() && $('#form_patient_date_der_nouvelles').val()){
        // To set two dates to two variables
        var date1 = new Date($('#form_patient_chir_date_ope').val());
        var date2 = new Date($('#form_patient_date_der_nouvelles').val());
        var Difference = (date2 - date1)/86400000;
        $('#suivi_jour').val(Difference)
    }else{
        $('#suivi_jour').val(0)
    }
}

function deleteUser (id) {
    iziToast.question({
        timeout: false,
        close: false,
        overlay: true,
        displayMode: 'once',
        id: 'question',
        zindex: 999,
        title: 'Confirmation:',
        message: 'Êtes-vous sûr de vouloir supprimer ce patient ?',
        position: 'center',
        buttons: [
            ['<button><b>OUI</b></button>', function (instance, toast) {
                // Make a request for a user with a given ID
                axios.get('/formulaire/'+id)
                    .then(function (response) {
                     //   alert(response.data)
                        $(location).attr("href", "/");
                    })
                    .catch(function (error) {
                        // handle error
                        iziToast.error({
                            timeout: 20000,
                            title: 'Error',
                            message: ''+error,
                        });
                        console.log(error);
                    })
                    .finally(function () {
                        // always executed
                    });
                instance.hide({ transitionOut: 'fadeOut' }, toast, 'button');
            }, true],
            ['<button>NON</button>', function (instance, toast) {
                instance.hide({ transitionOut: 'fadeOut' }, toast, 'button');
            }]
        ],
        onClosing: function(instance, toast, closedBy){
            console.info('Closing | closedBy: ' + closedBy);
        },
        onClosed: function(instance, toast, closedBy){
            console.info('Closed | closedBy: ' + closedBy);
        }
    });
}



