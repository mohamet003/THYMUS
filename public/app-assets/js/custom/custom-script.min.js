
$(document).ready(function () {

    /**
     * Début d'initialisation des champs'
     */

    cancer()
    cardiopathie()
    wedge()
    lobectomie()

    if ($("#form_patient_chir_abord").val() !== "thoracoscopie"){
        $('#divAbord').hide()
       $('#form_patient_chir_thoracos').val('')
    }

    if ($("#form_patient_histo_pre_op").val() !== "Autre"){
        $('#form_patient_autre_histo_pre_op').attr('disabled','disabled')
        $('#form_patient_autre_histo_pre_op').val('')
    }

    if ($("#form_patient_mode_obt_his_pre_ope").val() !== "Autre"){
        $('#form_patient_autre_mode_obt_his_pre_ope').attr('disabled','disabled')
        $('#form_patient_autre_mode_obt_his_pre_ope').val('')
    }

    if ($("#form_patient_cons_neu_dep_mg_pre_op").val() !== "Autre"){
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').attr('disabled','disabled')
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').val('')
    }

    if ($("#form_patient_trai_fond_myasthenie").val() !== "Autre"){
        $('#form_patient_autre_trai_fond_myasthenie').attr('disabled','disabled')
        $('#form_patient_autre_trai_fond_myasthenie').val('')
    }

    if ($("#form_patient_tdm").val() !== "Oui"){
        $('#form_patient_autre_tdm').attr('disabled','disabled')
        $('#form_patient_autre_tdm').val('')
    }

    if ($("#form_patient_petscan").val() !== "Oui"){
        $('#form_patient_autre_petscan').attr('disabled','disabled')
        $('#form_patient_autre_petscan').val('')
    }

    if ($("#form_patient_tnm_t").val() !== "Autre"){
        $('#form_patient_autre_tnm_t').attr('disabled','disabled')
        $('#form_patient_autre_tnm_t').val('')
    }

    if ($("#form_patient_tnm_n").val() !== "Autre"){
        $('#form_patient_autre_tnm_n').attr('disabled','disabled')
        $('#form_patient_autre_tnm_n').val('')
    }

    if ($("#form_patient_tnm_m").val() !== "Autre"){
        $('#form_patient_autre_tnm_m').attr('disabled','disabled')
        $('#form_patient_autre_tnm_m').val('')
    }

    if ($("#form_patient_tnm_stade_ctnm").val() !== "Autre"){
        $('#form_patient_autre_stade').attr('disabled','disabled')
        $('#form_patient_autre_stade').val('')
    }

    /**
     * Fin d'initialisation des champs'
     */



    /**
     * Début des calculs
     */

    $('#form_patient_poids').on('change',function ($) {
       calculeImc()
   })

    $('#form_patient_taille').on('change',function ($) {
        calculeImc()
    })

    $('#form_patient_ddn').on('change',function ($) {
        calculeAge()
    })

    $("#cancer_chec").on('change',function () {
         cancer()
    })

    $("#cardiopathie_chec").on('change',function () {
        cardiopathie()
    })

    $("#tabagisme_chec").on('change',function () {
        tabagisme()
    })

    $("#wedge_chec").on('change',function () {
        wedge()
    })

    $("#lobectomie_chec").on('change',function () {
        lobectomie()
    })


    /**
     * Fin des calculs
     */


})


function abordOnChange(event) {
    console.log(document.getElementById("form_patient_chir_thoracos").disabled)
    if ($(event.target).val() === "thoracoscopie"){
        $('#divAbord').show()
    }else{
        $('#form_patient_chir_thoracos').val('')
        $('#divAbord').hide()
    }
}

function tOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_tnm_t').removeAttr('disabled')
        $('#form_patient_autre_tnm_t').focus()
    }else{
        $('#form_patient_autre_tnm_t').attr('disabled','disabled')
        $('#form_patient_autre_tnm_t').val('')
    }
}

function nOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_tnm_n').removeAttr('disabled')
        $('#form_patient_autre_tnm_n').focus()
    }else{
        $('#form_patient_autre_tnm_n').attr('disabled','disabled')
        $('#form_patient_autre_tnm_n').val('')
    }
}

function mOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_tnm_m').removeAttr('disabled')
        $('#form_patient_autre_tnm_m').focus()
    }else{
        $('#form_patient_autre_tnm_m').attr('disabled','disabled')
        $('#form_patient_autre_tnm_m').val('')
    }
}

function stadeOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_stade').removeAttr('disabled')
        $('#form_patient_autre_stade').focus()
    }else{
        $('#form_patient_autre_stade').attr('disabled','disabled')
        $('#form_patient_autre_stade').val('')
    }
}


function tdmOnChange(event) {
    if ($(event.target).val() === "Oui"){
        $('#form_patient_autre_tdm').removeAttr('disabled')
        $('#form_patient_autre_tdm').focus()
    }else{
        $('#form_patient_autre_tdm').attr('disabled','disabled')
        $('#form_patient_autre_tdm').val('')
    }
}


function petscanOnChange(event) {
    if ($(event.target).val() === "Oui"){
        $('#form_patient_autre_petscan').removeAttr('disabled')
        $('#form_patient_autre_petscan').focus()
    }else{
        $('#form_patient_autre_petscan').attr('disabled','disabled')
        $('#form_patient_autre_petscan').val('')
    }
}


function consNeuOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').removeAttr('disabled')
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').focus()
    }else{
        $('#form_patient_autre_cons_neu_dep_mg_pre_op').attr('disabled','disabled')
    }
}

function traiFondOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_trai_fond_myasthenie').removeAttr('disabled')
        $('#form_patient_autre_trai_fond_myasthenie').focus()
    }else{
        $('#form_patient_autre_trai_fond_myasthenie').attr('disabled','disabled')
    }
}


function histoOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_histo_pre_op').removeAttr('disabled')
        $('#form_patient_autre_histo_pre_op').focus()
    }else{
        $('#form_patient_autre_histo_pre_op').attr('disabled','disabled')
    }
}

function modeHistoOnChange(event) {
    if ($(event.target).val() === "Autre"){
        $('#form_patient_autre_mode_obt_his_pre_ope').removeAttr('disabled')
        $('#form_patient_autre_mode_obt_his_pre_ope').focus()
    }else{
        $('#form_patient_autre_mode_obt_his_pre_ope').attr('disabled','disabled')
    }
}

function cancer() {
    var checkBox = document.getElementById("cancer_chec");
    if (checkBox.checked){
        $('#cancer').removeAttr('disabled')
        $('#cancer').focus()
    }else{
        $('#cancer').attr('disabled','disabled')
    }
}

function lobectomie() {
    var checkBox = document.getElementById("lobectomie_chec");
    if (checkBox.checked){
        $('#lobectomie').removeAttr('disabled')
        $('#lobectomie').focus()
    }else{
        $('#lobectomie').attr('disabled','disabled')
    }
}


function wedge() {
    var checkBox = document.getElementById("wedge_chec");
    if (checkBox.checked){
        $('#wedge').removeAttr('disabled')
        $('#wedge').focus()
    }else{
        $('#wedge').attr('disabled','disabled')
    }
}


function cardiopathie() {
    var checkBox = document.getElementById("cardiopathie_chec");
    if (checkBox.checked){
        $('#cardiopathie').removeAttr('disabled')
        $('#cardiopathie').focus()
    }else{
        $('#cardiopathie').attr('disabled','disabled')
    }
}

function tabagisme() {
    var checkBox = document.getElementById("tabagisme_chec");
    if (checkBox.checked){
        $('#tabagisme').removeAttr('disabled')
        $('#tabagisme').focus()
    }else{
        $('#tabagisme').attr('disabled','disabled')
    }
}



function calculeAge() {

    if ($('#form_patient_ddn').val()){
        var d = new Date();
        var ddn = new Date($('#form_patient_ddn').val())
        var y = d.getFullYear();
        var yn = ddn.getFullYear();
        console.log(ddn)
        var rslt = y - yn
        $('#form_patient_age').val(rslt)
    }else{
        $('#form_patient_age').val(0)
    }
}

function calculeImc() {

    if ($('#form_patient_taille').val()){
        var rst = $('#form_patient_poids').val() /( ($('#form_patient_taille').val()/100) *  ($('#form_patient_taille').val()/100) )
        $('#form_patient_imc').val(rst.toFixed(2))
    }else{
        $('#form_patient_imc').val(0)
    }

}

